=========================
Wagtail 0.4 release notes
=========================


Whats new
=========

Front-end permissions
~~~~~~~~~~~~~~~~~~~~~

TODO


Python 3 support
~~~~~~~~~~~~~~~~

Wagtail now supports Python 3.2, 3.3 and 3.4.


Scheduled publishing
~~~~~~~~~~~~~~~~~~~~

Editors can now schedule pages to be published or unpublished at specified times.

A new management command has been added (``publish_scheduled_pages``) to publish pages that have been scheduled by an Editor.

TODO: Link to docs


Search on QuerySet with Elasticsearch
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Its now possible to perform searches with Elasticsearch on ``PageQuerySet``s.

Example:

    >>> from wagtail.wagtailcore.models import Page
    >>> Page.objects.live().descendant_of(events_index).search("Hello")
    [<Page: Event 1>, <Page: Event 2>]



Sitemap generation
~~~~~~~~~~~~~~~~~~

A new module has been added (``wagtail.contrib.wagtailsitemaps``) which produces XML sitemaps for Wagtail sites.

TODO: Link to docs


Front-end cache invalidation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

A new module has been added (``wagtail.contrib.wagtailfrontendcache``) which invalidates pages in a frontend cache when they are updated or deleted in Wagtail.

TODO: Link to docs


Notification preferences
~~~~~~~~~~~~~~~~~~~~~~~~

Users can now decide which notifications they recieve from Wagtail using a new "Notification preferences" section located in the accound settings section.


Minor features
~~~~~~~~~~~~~~

Core
----

 * Any extra arguments given to ``Page.serve`` are now passed through to ``get_context`` and ``get_template``
 * Added ``in_menu`` and ``not_in_menu`` methods to ``PageQuerySet``
 * Added ``get_next_siblings`` and ``get_prev_siblings`` to ``Page``
 * Added ``page_published`` signal
 * Added ``copy`` method to ``Page`` to allow copying of pages
 * Added ``construct_whitelister_element_rules`` hook for customising the HTML whitelist used when saving ``RichText`` fields
 * Support for setting a ``subpage_types`` property on ``Page`` models, to define which page types are allowed as subpages


Admin
-----

 * Removed the "More" section from the admin menu
 * Added pagination to page listings in admin
 * Added a new datetime picker widget
 * Updated hallo.js to version 1.0.4
 * Aesthetic improvements to preview experience
 * Login screen redirects to dashboard if user is already logged in
 * Snippets are now ordered alphabetically
 * Added ``init_new_page`` signal


Images
------

 * Added ``original`` as a resizing rule supported by the ``{% image %}`` tag
 * ``image`` tag now accepts extra keyword arguments to be output as attributes on the img tag
 * Added an ``attrs`` property to image rendition objects to output ``src``, ``width``, ``height`` and ``alt`` attributes all in one go


Other
-----
 * Added styleguide (mainly for wagtail developers)


Bug fixes
~~~~~~~~~

 * Animated GIFs are now coalesced before resizing
 * Wand backend clones images before modifying them
 * Admin breadcrumb now positioned correctly on mobile
 * Page chooser breadcrumb now updates the chooser modal instead of linking to Explorer
 * Embeds - Fixed crash when no HTML field is sent back from the embed provider
 * Multiple sites with same hostname but different ports are now allowed
 * No longer possible to create multiple sites with ``is_default_site = True``


Backwards incompatible changes
==============================

ElasticUtils/pyelasticsearch has now been replaced with elasticsearch-py
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

TODO


Deprecated features
===================

 * Renamed some template tag libraries

TODO: Write some more about renamed template tags

TODO: Search wagtail codebase for any new DeprecationWarnings
